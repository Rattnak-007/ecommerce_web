{% extends 'ecommerce/base.html' %} {% load static %} {% block title %} Admin
Dashboard {% endblock %} {% block content %}
<link rel="stylesheet" href="{% static 'assets/Css/dashboard.css' %}">
{% block extra_css %}{% endblock %}
<div class="container py-5">
  <!-- Information Section -->
  <div class="row mb-4">
    <div class="col-12">
      <div class="info-card">
        <h3>Welcome, Admin!</h3>
        <p>
          Total Customers: <b>{{ customers|length|default:"0" }}</b> | Products:
          <b>{{ products|length|default:"0" }}</b> | Feature Products:
          <b>{{ feature_products|length|default:"0" }}</b> | Orders:
          <b>{{ orders|length|default:"0" }}</b> | Payments:
          <b>{{ payments|length|default:"0" }}</b> | Categories:
          <b>{{ categories|length|default:"0" }}</b> | Carts:
          <b>{{ carts|length|default:"0" }}</b>
        </p>
      </div>
    </div>
  </div>

  <!-- Dashboard Forms -->
  <div class="row dashboard-form-section">
    <!-- Add Category -->
    <div class="col-md-4">
      <h4>Add New Category</h4>
      <form
        method="post"
        action="{% url 'admin_dashboard' %}"
        enctype="multipart/form-data"
      >
        {% csrf_token %}
        <div class="mb-3">
          <label for="category_name" class="form-label">Category Name</label>
          <input
            type="text"
            name="category_name"
            id="category_name"
            class="form-control"
            required
          />
        </div>
        <div class="mb-3">
          <label for="category_visible" class="form-label">Visible</label>
          <select
            name="category_visible"
            id="category_visible"
            class="form-select"
          >
            <option value="true" selected>Yes</option>
            <option value="false">No</option>
          </select>
        </div>
        <button type="submit" name="add_category" class="btn btn-success w-100">
          Add Category
        </button>
      </form>
    </div>

    <!-- Add Product -->
    <div class="col-md-4">
      <h4>Add New Product</h4>
      <form
        method="post"
        action="{% url 'admin_dashboard' %}"
        enctype="multipart/form-data"
      >
        {% csrf_token %}
        <div class="mb-3">
          <label for="product_name" class="form-label">Product Name</label>
          <input
            type="text"
            name="product_name"
            id="product_name"
            class="form-control"
            required
          />
        </div>
        <div class="mb-3">
          <label for="product_category" class="form-label">Category</label>
          <select
            name="product_category"
            id="product_category"
            class="form-select"
            required
          >
            <option value="" disabled selected>Select Category</option>
            {% for category in categories %}
            <option value="{{ category.category_id }}">
              {{ category.name }}
            </option>
            {% endfor %}
          </select>
        </div>
        <div class="mb-3">
          <label for="product_price" class="form-label">Price</label>
          <input
            type="number"
            name="product_price"
            id="product_price"
            class="form-control"
            step="0.01"
            min="0"
            required
          />
        </div>
        <div class="mb-3">
          <label for="product_stock" class="form-label">Stock</label>
          <input
            type="number"
            name="product_stock"
            id="product_stock"
            class="form-control"
            min="0"
            required
          />
        </div>
        <div class="mb-3">
          <label for="product_image" class="form-label">Image</label>
          <input
            type="file"
            name="product_image"
            id="product_image"
            class="form-control"
          />
        </div>
        <div class="mb-3">
          <label for="product_description" class="form-label"
            >Description</label
          >
          <textarea
            name="product_description"
            id="product_description"
            class="form-control"
            rows="2"
          ></textarea>
        </div>
        <button type="submit" name="add_product" class="btn btn-primary w-100">
          Add Product
        </button>
      </form>
    </div>

    <!-- Add Feature Product -->
    <div class="col-md-4">
      <h4>Add Feature Product</h4>
      <form
        method="post"
        action="{% url 'admin_dashboard' %}"
        enctype="multipart/form-data"
      >
        {% csrf_token %}
        <div class="mb-3">
          <label for="feature_name" class="form-label"
            >Feature Product Name</label
          >
          <input
            type="text"
            name="feature_name"
            id="feature_name"
            class="form-control"
            required
          />
        </div>
        <div class="mb-3">
          <label for="feature_category" class="form-label">Category</label>
          <select
            name="feature_category"
            id="feature_category"
            class="form-select"
            required
          >
            <option value="" disabled selected>Select Category</option>
            {% for category in categories %}
            <option value="{{ category.category_id }}">
              {{ category.name }}
            </option>
            {% endfor %}
          </select>
        </div>
        <div class="mb-3">
          <label for="feature_price" class="form-label">Price</label>
          <input
            type="number"
            name="feature_price"
            id="feature_price"
            class="form-control"
            step="0.01"
            min="0"
            required
          />
        </div>
        <div class="mb-3">
          <label for="feature_discount" class="form-label">Discount</label>
          <input
            type="number"
            name="feature_discount"
            id="feature_discount"
            class="form-control"
            step="0.01"
            min="0"
          />
        </div>
        <div class="mb-3">
          <label for="feature_stock" class="form-label">Stock</label>
          <input
            type="number"
            name="feature_stock"
            id="feature_stock"
            class="form-control"
            min="0"
            required
          />
        </div>
        <div class="mb-3">
          <label for="feature_image" class="form-label">Image</label>
          <input
            type="file"
            name="feature_image"
            id="feature_image"
            class="form-control"
          />
        </div>
        <div class="mb-3">
          <label for="feature_description" class="form-label"
            >Description</label
          >
          <textarea
            name="feature_description"
            id="feature_description"
            class="form-control"
            rows="2"
          ></textarea>
        </div>
        <button
          type="submit"
          name="add_feature_product"
          class="btn btn-warning w-100"
        >
          Add Feature Product
        </button>
      </form>
    </div>
  </div>

  <!-- Data Tables Section -->
  {% comment %} Customers Table {% endcomment %}
  <h4>All Customers</h4>
  <div class="table-responsive mb-5">
    <table class="table table-bordered table-hover align-middle">
      <thead class="table-light">
        <tr>
          <th>Customer ID</th>
          <th>Name</th>
          <th>Email</th>
          <th>Phone</th>
          <th>Address</th>
          <th>Is Staff</th>
        </tr>
      </thead>
      <tbody>
        {% for customer in customers %}
        <tr>
          <td>{{ customer.customer_id }}</td>
          <td>{{ customer.name }}</td>
          <td>{{ customer.email }}</td>
          <td>{{ customer.phone }}</td>
          <td>{{ customer.address }}</td>
          <td>
            {% if customer.is_staff %}
            <span class="badge bg-primary">Admin</span>
            {% else %}
            <span class="badge bg-secondary">User</span>
            {% endif %}
          </td>
        </tr>
        {% empty %}
        <tr>
          <td colspan="6" class="text-center">No customers found.</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

  <!-- Products Table -->
  <h4>All Products</h4>
  <div class="table-responsive mb-5">
    <table class="table table-bordered table-hover align-middle">
      <thead class="table-light">
        <tr>
          <th>Product ID</th>
          <th>Name</th>
          <th>Category</th>
          <th>Price</th>
          <th>Stock</th>
          <th>Available</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        {% for product in products %}
        <tr>
          <td>{{ product.product_id }}</td>
          <td>{{ product.name }}</td>
          <td>{{ product.category.name }}</td>
          <td>${{ product.price|floatformat:2 }}</td>
          <td>{{ product.stock }}</td>
          <td>
            {% if product.is_available %}
            <span class="badge bg-success">Yes</span>
            {% else %}
            <span class="badge bg-danger">No</span>
            {% endif %}
          </td>
          <td>
            <div class="action-btns">
              <a
                href="{% url 'admin_edit_product' product.product_id %}"
                class="btn btn-edit btn-sm"
              >
                <i class="fas fa-edit"></i> Edit
              </a>
              <form
                method="post"
                action="{% url 'admin_delete_product' product.product_id %}"
                style="display: inline"
              >
                {% csrf_token %}
                <button
                  type="submit"
                  class="btn btn-delete btn-sm"
                  onclick="return confirm('Are you sure you want to delete this product?');"
                >
                  <i class="fas fa-trash"></i> Delete
                </button>
              </form>
            </div>
          </td>
        </tr>
        {% empty %}
        <tr>
          <td colspan="7" class="text-center">No products found.</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

  <!-- Feature Products Table -->
  <h4>All Feature Products</h4>
  <div class="table-responsive mb-5">
    <table class="table table-bordered table-hover align-middle">
      <thead class="table-light">
        <tr>
          <th>Feature Product ID</th>
          <th>Name</th>
          <th>Category</th>
          <th>Price</th>
          <th>Discount</th>
          <th>Stock</th>
          <th>Available</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        {% for product in feature_products %}
        <tr>
          <td>{{ product.Feature_Product_id }}</td>
          <td>{{ product.name }}</td>
          <td>{{ product.category.name }}</td>
          <td>${{ product.price|floatformat:2 }}</td>
          <td>
            {% if product.discount and product.discount > 0 %}
            <span class="badge bg-warning"
              >${{ product.discount|floatformat:2 }}</span
            >
            {% else %} - {% endif %}
          </td>
          <td>{{ product.stock }}</td>
          <td>
            {% if product.is_available %}
            <span class="badge bg-success">Yes</span>
            {% else %}
            <span class="badge bg-danger">No</span>
            {% endif %}
          </td>
          <td>
            <div class="action-btns">
              <a
                href="{% url 'admin_edit_feature_product' product.Feature_Product_id %}"
                class="btn btn-edit btn-sm"
              >
                <i class="fas fa-edit"></i> Edit
              </a>
              <form
                method="post"
                action="{% url 'admin_delete_feature_product' product.Feature_Product_id %}"
                style="display: inline"
              >
                {% csrf_token %}
                <button
                  type="submit"
                  class="btn btn-delete btn-sm"
                  onclick="return confirm('Are you sure you want to delete this feature product?');"
                >
                  <i class="fas fa-trash"></i> Delete
                </button>
              </form>
            </div>
          </td>
        </tr>
        {% empty %}
        <tr>
          <td colspan="8" class="text-center">No feature products found.</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

  <!-- Orders Table -->
  <h4 id="order">All Orders</h4>
  <div class="table-responsive mb-5">
    <table class="table table-bordered table-hover align-middle">
      <thead class="table-light">
        <tr>
          <th>Order ID</th>
          <th>Customer</th>
          <th>Reference</th>
          <th>Amount</th>
          <th>Status</th>
          <th>Date</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        {% for order in orders %}
        <tr>
          <td>{{ order.order_id }}</td>
          <td>{{ order.customer.name }}</td>
          <td>{{ order.booking_reference }}</td>
          <td>${{ order.amount|floatformat:2 }}</td>
          <td>{{ order.status }}</td>
          <td>{{ order.created_at|date:"Y-m-d H:i" }}</td>
          <td>
            <a href="{% url 'admin_edit_order' order.order_id %}" class="btn btn-edit btn-sm">
              <i class="fas fa-edit"></i> Edit
            </a>
            <form method="post" action="{% url 'admin_delete_order' order.order_id %}" style="display:inline;">
              {% csrf_token %}
              <button type="submit" class="btn btn-delete btn-sm"
                onclick="return confirm('Are you sure you want to delete this order?');">
                <i class="fas fa-trash"></i> Delete
              </button>
            </form>
          </td>
        </tr>
        {% empty %}
        <tr>
          <td colspan="7" class="text-center">No orders found.</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

  <!-- Payments Table -->
  <h4 id="payment" >All Payments</h4>
  <div class="table-responsive mb-5">
    <table class="table table-bordered table-hover align-middle">
      <thead class="table-light">
        <tr>
          <th>Payment ID</th>
          <th>Reference</th>
          <th>Order</th>
          <th>Customer</th>
          <th>Amount</th>
          <th>Status</th>
          <th>Method</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        {% for payment in payments %}
        <tr>
          <td>{{ payment.payment_id }}</td>
          <td>{{ payment.payment_reference }}</td>
          <td>{{ payment.order.booking_reference }}</td>
          <td>{{ payment.customer.name }}</td>
          <td>${{ payment.amount|floatformat:2 }}</td>
          <td>{{ payment.status }}</td>
          <td>{{ payment.payment_method }}</td>
          <td>
            <a href="{% url 'admin_edit_payment' payment.payment_id %}" class="btn btn-edit btn-sm">
              <i class="fas fa-edit"></i> Edit
            </a>
            <form method="post" action="{% url 'admin_delete_payment' payment.payment_id %}" style="display:inline;">
              {% csrf_token %}
              <button type="submit" class="btn btn-delete btn-sm"
                onclick="return confirm('Are you sure you want to delete this payment?');">
                <i class="fas fa-trash"></i> Delete
              </button>
            </form>
          </td>
        </tr>
        {% empty %}
        <tr>
          <td colspan="8" class="text-center">No payments found.</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

  <!-- Categories Table -->
  <h4 id="category" >All Categories</h4>
  <div class="table-responsive mb-5">
    <table class="table table-bordered table-hover align-middle">
      <thead class="table-light">
        <tr>
          <th>Category ID</th>
          <th>Name</th>
          <th>Visible</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        {% for category in categories %}
        <tr>
          <td>{{ category.category_id }}</td>
          <td>{{ category.name }}</td>
          <td>
            {% if category.visible %}
              <span class="badge bg-success">Yes</span>
            {% else %}
              <span class="badge bg-danger">No</span>
            {% endif %}
          </td>
          <td>
            <a href="{% url 'admin_edit_category' category.category_id %}" class="btn btn-edit btn-sm">
              <i class="fas fa-edit"></i> Edit
            </a>
            <form method="post" action="{% url 'admin_delete_category' category.category_id %}" style="display:inline;">
              {% csrf_token %}
              <button type="submit" class="btn btn-delete btn-sm"
                onclick="return confirm('Are you sure you want to delete this category?');">
                <i class="fas fa-trash"></i> Delete
              </button>
            </form>
          </td>
        </tr>
        {% empty %}
        <tr>
          <td colspan="4" class="text-center">No categories found.</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
  <!-- ...existing code... -->
</div>
{% endblock %}
