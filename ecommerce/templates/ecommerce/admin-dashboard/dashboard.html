{% extends 'ecommerce/base.html' %} {% load static %} {% block title %}Admin Dashboard {% endblock %} 
{% block content %}
<style>
  /* Dashboard Main Styling */
  body {
    background: #f4f7fa;
    font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
  }

  /* Header */
  h2,
  h4 {
    font-weight: 700;
    color: #2d3748;
    letter-spacing: -1px;
  }

  /* Card Grid */
  .row.mb-4 > .col-md-2 {
    margin-bottom: 1rem;
  }

  /* Stat Cards */
  .card {
    border: none;
    border-radius: 18px;
    box-shadow: 0 4px 24px rgba(67, 97, 238, 0.08),
      0 1.5px 6px rgba(0, 0, 0, 0.03);
    transition: transform 0.2s, box-shadow 0.2s;
    background: #fff;
  }

  .card:hover {
    transform: translateY(-4px) scale(1.03);
    box-shadow: 0 8px 32px rgba(67, 97, 238, 0.13),
      0 3px 12px rgba(0, 0, 0, 0.06);
  }

  .card .card-title {
    font-size: 1.1rem;
    font-weight: 600;
    color: #6c757d;
    margin-bottom: 0.5rem;
  }

  .card .display-6 {
    font-size: 2.2rem;
    font-weight: bold;
    color: #4361ee;
    margin-bottom: 0;
  }

  /* Table Styling */
  .table {
    background: #fff;
    border-radius: 12px;
    overflow: hidden;
    margin-bottom: 0;
    box-shadow: 0 2px 12px rgba(67, 97, 238, 0.04);
  }

  .table th {
    background: linear-gradient(90deg, #4361ee 80%, #ffd166 100%);
    color: #fff;
    font-weight: 600;
    border: none;
    font-size: 1rem;
    letter-spacing: 0.5px;
  }

  .table td {
    vertical-align: middle;
    font-size: 0.98rem;
    color: #2d3748;
    border-top: 1px solid #f1f5ff;
  }

  .table-hover tbody tr:hover {
    background: #f1f5ff;
    transition: background 0.2s;
  }

  .table-responsive {
    border-radius: 12px;
    overflow-x: auto;
    margin-bottom: 2rem;
  }

  /* Badges */
  .badge {
    padding: 6px 14px;
    font-size: 0.92rem;
    border-radius: 8px;
    font-weight: 600;
    letter-spacing: 0.5px;
  }

  .bg-success {
    background: #06d6a0 !important;
    color: #fff !important;
  }

  .bg-danger {
    background: #ff6b6b !important;
    color: #fff !important;
  }

  .bg-primary {
    background: #4361ee !important;
    color: #fff !important;
  }

  .bg-secondary {
    background: #718096 !important;
    color: #fff !important;
  }

  /* Section Titles */
  h4 {
    margin-top: 2.5rem;
    margin-bottom: 1.2rem;
    color: #4361ee;
    font-weight: 700;
    border-left: 5px solid #ffd166;
    padding-left: 12px;
  }

  /* Info Card */
  .info-card {
    background: linear-gradient(90deg, #4361ee 80%, #ffd166 100%);
    color: #fff;
    border-radius: 16px;
    box-shadow: 0 2px 12px rgba(67, 97, 238, 0.09);
    padding: 2rem 1.5rem;
    margin-bottom: 2rem;
    text-align: center;
  }

  .info-card h3 {
    font-size: 2.2rem;
    font-weight: 800;
    margin-bottom: 0.5rem;
  }

  .info-card p {
    font-size: 1.1rem;
    margin-bottom: 0;
  }

  /* Dashboard Form Section */
  .dashboard-form-section {
    background: #fff;
    border-radius: 14px;
    box-shadow: 0 2px 12px rgba(67, 97, 238, 0.06);
    padding: 2rem 1.5rem;
    margin-bottom: 2.5rem;
  }

  .dashboard-form-section h4 {
    color: #4361ee;
    font-weight: 700;
    margin-bottom: 1.5rem;
    border-left: 5px solid #ffd166;
    padding-left: 12px;
  }

  .form-label {
    font-weight: 600;
    color: #2d3748;
  }

  .form-control,
  .form-select {
    border-radius: 8px;
    border: 1px solid #e2e8f0;
  }

  .dashboard-form-section .btn {
    font-weight: 700;
    border-radius: 8px;
    padding: 0.6rem 1.5rem;
  }

  /* Responsive Adjustments */
  @media (max-width: 991px) {
    .row.mb-4 > .col-md-2 {
      flex: 0 0 50%;
      max-width: 50%;
    }

    .card .display-6 {
      font-size: 1.3rem;
    }

    .table-responsive {
      font-size: 0.95rem;
    }
  }

  @media (max-width: 768px) {
    .row.mb-4 > .col-md-2 {
      flex: 0 0 100%;
      max-width: 100%;
      margin-bottom: 1.2rem;
    }

    .table-responsive {
      font-size: 0.92rem;
    }

    h2 {
      font-size: 2rem;
    }

    h4 {
      font-size: 1.2rem;
    }
  }

  /* Misc */
  ::-webkit-scrollbar {
    width: 8px;
    background: #f1f5ff;
  }

  ::-webkit-scrollbar-thumb {
    background: #e2e8f0;
    border-radius: 8px;
  }
</style>

<div class="container py-5">
  <!-- Information Section -->
  <div class="row mb-4">
    <div class="col-12">
      <div class="info-card">
        <h3>Welcome, Admin!</h3>
        <p>
          Total Customers: <b>{{ customers|length }}</b> | Products:
          <b>{{ products|length }}</b> | Feature Products:
          <b>{% if feature_products %}{{ feature_products|length }}{% else %}0{% endif %}</b>| Orders: <b>{{ orders|length }}</b> | Payments:
          <b>{{ payments|length }}</b> | Categories:
          <b>{{ categories|length }}</b> | Carts: <b>{{ carts|length }}</b>
        </p>
      </div>
    </div>
  </div>

  <!-- Add Category/Product Forms -->
  <div class="row dashboard-form-section">
    <div class="col-md-6">
      <h4>Add New Category</h4>
      <form
        method="post"
        action="{% url 'admin_dashboard' %}"
        enctype="multipart/form-data"
        class="mb-4"
      >
        {% csrf_token %}
        <div class="mb-3">
          <label for="category_name" class="form-label">Category Name</label>
          <input
            type="text"
            name="category_name"
            id="category_name"
            class="form-control"
            required
          />
        </div>
        <div class="mb-3">
          <label for="category_visible" class="form-label">Visible</label>
          <select
            name="category_visible"
            id="category_visible"
            class="form-select"
          >
            <option value="true" selected>Yes</option>
            <option value="false">No</option>
          </select>
        </div>
        <button type="submit" name="add_category" class="btn btn-success w-100">
          Add Category
        </button>
      </form>
    </div>
    <div class="col-md-6">
      <h4>Add New Product</h4>
      <form
        method="post"
        action="{% url 'admin_dashboard' %}"
        enctype="multipart/form-data"
        class="mb-4"
      >
        {% csrf_token %}
        <div class="mb-3">
          <label for="product_name" class="form-label">Product Name</label>
          <input
            type="text"
            name="product_name"
            id="product_name"
            class="form-control"
            required
          />
        </div>
        <div class="mb-3">
          <label for="product_category" class="form-label">Category</label>
          <select
            name="product_category"
            id="product_category"
            class="form-select"
            required
          >
            <option value="" disabled selected>Select Category</option>
            {% for category in categories %}
            <option value="{{ category.category_id }}">
              {{ category.name }}
            </option>
            {% endfor %}
          </select>
        </div>
        <div class="mb-3">
          <label for="product_price" class="form-label">Price</label>
          <input
            type="number"
            name="product_price"
            id="product_price"
            class="form-control"
            step="0.01"
            min="0"
            required
          />
        </div>
        <div class="mb-3">
          <label for="product_stock" class="form-label">Stock</label>
          <input
            type="number"
            name="product_stock"
            id="product_stock"
            class="form-control"
            min="0"
            required
          />
        </div>
        <div class="mb-3">
          <label for="product_image" class="form-label">Image</label>
          <input
            type="file"
            name="product_image"
            id="product_image"
            class="form-control"
          />
        </div>
        <div class="mb-3">
          <label for="product_description" class="form-label"
            >Description</label
          >
          <textarea
            name="product_description"
            id="product_description"
            class="form-control"
            rows="2"
          ></textarea>
        </div>
        <button type="submit" name="add_product" class="btn btn-primary w-100">
          Add Product
        </button>
      </form>
    </div>
  </div>

  <!-- Data Tables Section -->
  <h4 class="mb-3">All Customers</h4>
  <div class="table-responsive mb-5">
    <table class="table table-bordered table-hover align-middle">
      <thead class="table-light">
        <tr>
          <th>Customer ID</th>
          <th>Name</th>
          <th>Email</th>
          <th>Phone</th>
          <th>Address</th>
          <th>Is Staff</th>
        </tr>
      </thead>
      <tbody>
        {% for customer in customers %}
        <tr>
          <td>{{ customer.customer_id }}</td>
          <td>{{ customer.name }}</td>
          <td>{{ customer.email }}</td>
          <td>{{ customer.phone }}</td>
          <td>{{ customer.address }}</td>
          <td>
            {% if customer.is_staff %}
            <span class="badge bg-primary">Admin</span>
            {% else %}
            <span class="badge bg-secondary">User</span>
            {% endif %}
          </td>
        </tr>
        {% empty %}
        <tr>
          <td colspan="6" class="text-center">No customers found.</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

  <h4 class="mb-3">All Products</h4>
  <div class="table-responsive mb-5">
    <table class="table table-bordered table-hover align-middle">
      <thead class="table-light">
        <tr>
          <th>Product ID</th>
          <th>Name</th>
          <th>Category</th>
          <th>Price</th>
          <th>Stock</th>
          <th>Available</th>
        </tr>
      </thead>
      <tbody>
        {% for product in products %}
        <tr>
          <td>{{ product.product_id }}</td>
          <td>{{ product.name }}</td>
          <td>{{ product.category.name }}</td>
          <td>${{ product.price|floatformat:2 }}</td>
          <td>{{ product.stock }}</td>
          <td>
            {% if product.is_available %}
            <span class="badge bg-success">Yes</span>
            {% else %}
            <span class="badge bg-danger">No</span>
            {% endif %}
          </td>
        </tr>
        {% empty %}
        <tr>
          <td colspan="6" class="text-center">No products found.</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

  <h4 class="mb-3">All Feature Products</h4>
  <div class="table-responsive mb-5">
    <table class="table table-bordered table-hover align-middle">
      <thead class="table-light">
        <tr>
          <th>Feature Product ID</th>
          <th>Name</th>
          <th>Category</th>
          <th>Price</th>
          <th>Discount</th>
          <th>Stock</th>
          <th>Available</th>
        </tr>
      </thead>
      <tbody>
        {% if feature_products %} {% for product in feature_products %}
        <tr>
          <td>{{ product.Feature_Product_id }}</td>
          <td>{{ product.name }}</td>
          <td>{{ product.category.name }}</td>
          <td>${{ product.price|floatformat:2 }}</td>
          <td>
            {% if product.discount and product.discount > 0 %}
            <span class="badge bg-warning"
              >${{ product.discount|floatformat:2 }}</span
            >
            {% else %} - {% endif %}
          </td>
          <td>{{ product.stock }}</td>
          <td>
            {% if product.is_available %}
            <span class="badge bg-success">Yes</span>
            {% else %}
            <span class="badge bg-danger">No</span>
            {% endif %}
          </td>
        </tr>
        {% endfor %} {% else %}
        <tr>
          <td colspan="7" class="text-center">No feature products found.</td>
        </tr>
        {% endif %}
      </tbody>
    </table>
  </div>

  <h4 class="mb-3">All Orders</h4>
  <div class="table-responsive mb-5">
    <table class="table table-bordered table-hover align-middle">
      <thead class="table-light">
        <tr>
          <th>Order ID</th>
          <th>Customer</th>
          <th>Amount</th>
          <th>Status</th>
          <th>Payment Status</th>
          <th>Created At</th>
        </tr>
      </thead>
      <tbody>
        {% for order in orders %}
        <tr>
          <td>{{ order.order_id }}</td>
          <td>{{ order.customer.name }}</td>
          <td>${{ order.amount|floatformat:2 }}</td>
          <td>{{ order.status }}</td>
          <td>{{ order.payment_status }}</td>
          <td>{{ order.created_at|date:"Y-m-d H:i" }}</td>
        </tr>
        {% empty %}
        <tr>
          <td colspan="6" class="text-center">No orders found.</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

  <h4 class="mb-3">All Payments</h4>
  <div class="table-responsive mb-5">
    <table class="table table-bordered table-hover align-middle">
      <thead class="table-light">
        <tr>
          <th>Payment ID</th>
          <th>Reference</th>
          <th>Amount</th>
          <th>Method</th>
          <th>Status</th>
          <th>Customer</th>
          <th>Order</th>
          <th>Date</th>
        </tr>
      </thead>
      <tbody>
        {% for payment in payments %}
        <tr>
          <td>{{ payment.payment_id }}</td>
          <td>{{ payment.payment_reference }}</td>
          <td>${{ payment.amount|floatformat:2 }}</td>
          <td>{{ payment.payment_method }}</td>
          <td>{{ payment.status }}</td>
          <td>{{ payment.customer.name }}</td>
          <td>{{ payment.order.order_id }}</td>
          <td>{{ payment.payment_date|date:"Y-m-d H:i" }}</td>
        </tr>
        {% empty %}
        <tr>
          <td colspan="8" class="text-center">No payments found.</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

  <h4 class="mb-3">All Categories</h4>
  <div class="table-responsive mb-5">
    <table class="table table-bordered table-hover align-middle">
      <thead class="table-light">
        <tr>
          <th>Category ID</th>
          <th>Name</th>
          <th>Visible</th>
          <th>Created At</th>
        </tr>
      </thead>
      <tbody>
        {% for category in categories %}
        <tr>
          <td>{{ category.category_id }}</td>
          <td>{{ category.name }}</td>
          <td>
            {% if category.is_visible %}
            <span class="badge bg-success">Yes</span>
            {% else %}
            <span class="badge bg-danger">No</span>
            {% endif %}
          </td>
          <td>{{ category.created_at|date:"Y-m-d" }}</td>
        </tr>
        {% empty %}
        <tr>
          <td colspan="4" class="text-center">No categories found.</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

  <h4 class="mb-3">All Carts</h4>
  <div class="table-responsive mb-5">
    <table class="table table-bordered table-hover align-middle">
      <thead class="table-light">
        <tr>
          <th>Cart ID</th>
          <th>Customer</th>
          <th>Updated At</th>
        </tr>
      </thead>
      <tbody>
        {% for cart in carts %}
        <tr>
          <td>{{ cart.cart_id }}</td>
          <td>{{ cart.customer.name }}</td>
          <td>{{ cart.updated_at|date:"Y-m-d H:i" }}</td>
        </tr>
        {% empty %}
        <tr>
          <td colspan="3" class="text-center">No carts found.</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}